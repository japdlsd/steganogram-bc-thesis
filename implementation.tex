\chapter{Implementation}

In this chapter we will talk about main implmentation details of
our application.

\section{How to build the application}
In this section we will show how to build and install our application.

The process is very simple: you have to download all files and open them
in Android Studio. Some of the code is written in C++, so you'd need to 
use NDK if you want to build the application without Android Studio.

The application has been developed and tested on Android OS 4.4 .

\section{Overview of the design}
In this section we will show the general architecture of the application
and describe the main parts (e.g. classes, interfaces).

% TODO try to overview it by its functions: "what happened when we want to embed the message"


\section{Algorithms' settings}
In this section we will show concrete parameters of all used algorithms.

\subsection{Steganographic algorithm CE}

\paragraph{Separation ratio $\alpha$} We've chosen the same value as in the 
paper: $0.8$.

\paragraph{Adjustment parameter $\beta$} We've chosen the same value as in the paper: $\frac{1}{3}$.

\paragraph{Length of a message}
We've set maximum length of a block as 2 byte word, so the maximum length is 
$2^{16} = 65536$ bytes. Therefore, the maximum length of embedded message is 
$2^{16} (2 - \alpha) = 2^{16} (2 - 0.8) = 78643$ bytes.

\subsection{Generation of steganographic keys}

\subsection{Cryptographic algorithm AES}

\subsection{Generation of cryptographic keys}

\section{How to replace used algorithms}
In this section we will decribe the interfaces of used algorithms.

\subsection{Steganographic algorithm interface}
\texttt{DCTSteganography} interface has four functions.

Function \texttt{loadKeyFromString} takes one argument --- 
a string representation of a steganographic key. It returns
\texttt{true} if the key was successfully extracted and
\texttt{false} otherwise.

Function \texttt{generateStegoKeyString} returns a 
valid string representation of a newly created steganographic key 
(this string should be parseable by function \texttt{loadKeyFromString}).

Function \texttt{embed} takes two arguments: an integer array \texttt{coeffOrig}
representing quantized DCT coefficients of a cover image and an \texttt{InputStream} 
with bytes of a secret message we want to embed into the cover image. 
This function returns nothing, but it embeds the secret message into
the DCT coefficients. 

Function \texttt{extract} takes two arguments: an integer array \texttt{coeffOrig}
representing qunatized DCT coefficients of a cover image with embedded message
and an \texttt{ExtractionListener} that have to be called with the extracted message
as an argument.

\begin{lstlisting} 
public interface DCTSteganography {
    boolean loadKeyFromString (final String s);
    String generateStegoKeyString ();

    void embed (int[] coeffOrig, 
            final InputStream embeddedData);

    void extract (int[] coeffOrig,  
            ByteArrayOutputStream fos, Extract.ExtractionListener listener);
}
\end{lstlisting}

\subsection{Cryptographic algorithm interface}
\texttt{SymmetricEncryption} interface has four functions.

Function \texttt{loadKeyFromString} takes one argument --- 
a string representation of a cryptographic key. It returns
\texttt{true} if the key was successfully extracted and
\texttt{false} otherwise.

Function \texttt{generateCryptoKeyString} returns a 
valid string representation of a newly created cryptographic key 
(this string should be parseable by function \texttt{loadKeyFromString}).

Function \texttt{encrypt} takes one argument --- a byte array that represents
a message to be encrypted and returns a byte array representing the encrypted
message.

Function \texttt{decrypt} takes one argument --- a byte array that represents
an encrypted message and returns a byte array representing the original message.

\begin{lstlisting} 
public interface SymmetricEncryption {
    boolean loadKeyFromString (final String s);
    String generateCryptoKeyString ();
    byte[] encrypt (byte[] text);
    byte[] decrypt (byte[] message);
}
\end{lstlisting}

\subsection{Compression algorithm interface}

\texttt{Compression} interface has two functions:
\texttt{compress} and \texttt{decompress}. 

Function \texttt{compress}
takes one argument --- a~byte~array representing a~message and returns
a~byte~array with compressed message. 

Function \texttt{decompress}
takes one argument~---~a~byte~array representing a~compressed message
and returns a~byte~array with an~original message.

\begin{lstlisting} 
public interface Compression {
    byte[] compress (byte[] message);
    byte[] decompress (byte[] message);
}
\end{lstlisting}
